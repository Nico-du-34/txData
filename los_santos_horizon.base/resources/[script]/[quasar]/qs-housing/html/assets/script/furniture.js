const _0x13f0c0=_0x139e;!function(){for(var n=_0x139e,e=_0xe3e8();;)try{if(182837==+parseInt(n(335))*(parseInt(n(219))/2)+parseInt(n(238))/3+parseInt(n(308))/4+parseInt(n(149))/5*(-parseInt(n(283))/6)+-parseInt(n(300))/7*(-parseInt(n(338))/8)+parseInt(n(336))/9+-parseInt(n(324))/10)break;e.push(e.shift())}catch(n){e.push(e.shift())}}();import{Post,getOwnedObjects}from"./api.js";import*as _0x6a80ac from"three";import{TransformControls}from"three/addons/controls/TransformControls.js";let decorateMenu=null,editable=!1,editingData={};function setDecorateMenu(n){decorateMenu=n}const tracking={x:0,y:0},objectInfos={},furniData={prevY:[],prevX:[],prevZ:[],prevPitch:[],prevRoll:[],prevYaw:[]};let isTransforming=!1,editingId=null;const degToRad=n=>{var e=_0x139e,t={iLPAe:function(n,e){return n*e},OwWtj:function(n,e){return n/e}};return t[e(307)](n,t[e(229)](Math.PI,180))},radToDeg=n=>{var e=_0x139e,t={XujjD:function(n,e){return n*e},FbkXd:function(n,e){return n/e}};return t[e(257)](n,t[e(143)](180,Math.PI))},selectLegacyObject=async n=>{var e=_0x139e,t={DjsGH:function(n,e){return n!=e},oxcmN:function(n,e){return n==e},oKzGF:function(n){return n()},lWMcO:function(n,e){return n==e},dMHqR:function(n,e){return n<e},tLPDi:function(n,e){return n==e}};if(t[e(209)](decorateMenu,null)&&t[e(184)](decorateMenu[e(176)],2)){var r=await t[e(162)](getOwnedObjects);if(!t[e(256)](r[decorateMenu[e(267)][e(165)+"u"][e(285)]][e(305)],n)){for(var a=null,o=0;t[e(199)](o,r[e(222)]);o++)if(t[e(270)](r[o][e(305)],n)){a=o;break}t[e(209)](a,null)&&(decorateMenu[e(267)][e(165)+"u"][e(285)]=a),decorateMenu[e(267)][e(165)+"u"][e(176)]()}}};function _0xe3e8(){const n=["vdMdH","setMode","fGxwl","iVrrp","object","dtOnE","iLPAe","282144quauSu","exists","fov","MDIux","lper #mode","InjjU","render","y_info","oDamW","cMmnF","hit","cachS","Ztnhj","MeshPhongM","TPgqe","tagName","5992600YMUeDo","scrollWidt","offsetTop","tbafT","set","VnFxC","eDXJq","scale","IYOFa","YaZbv","BoxGeometr","43905pLBzGT","945405EqChxa","mousedown","2097944fYVdzm","setTransla","prevYaw","ement","#decorate","setSize","ity","0|1","ground_obj","VcQRd","rer","position","add","target","innerWidth","prevRoll","block","keydown","YusUs","ty-y","FbkXd","OyNHk","#object-he","roll","AXDoB","prevY","13370VLMhiN","distance","toggleCurs","aterial","IYEFP","GuTch","yaw","display","FlGkL","LEXzo","ectionMatr","OYnAB","XYpgJ","oKzGF","Perspectiv","eHLAt","sortingMen","PWLtl","KXKLL","NrxyS","uczQv","gGBQQ","prevPitch","rotation","2|4|3|0|1|","Mesh","kEhnS","sort","val","3|12|15|11","key","roaVh","ty-pitch","qaOxs","eOBrb","oxcmN","pageX","eCamera","appendChil","fUfUs","IOuTw","rotate","pitch","none","edit_entit","UUbmb","querySelec","eTAyX","LHFdj","lper #enti","dMHqR","AjWxp","Scene","WmmrN","LROiV","TGVmk","prevZ","lPkNz","|4|7|14|5|","QwmPu","DjsGH","KrKKv","gcBcU","eMovement","WgTrs","KfYFJ","pageY","wHcAw","KwgDv","CANVAS","16jBoDbb","PdCfv","tor","length","addEventLi","YZX","visible","ect","stener","mouseUp","OwWtj","ZQqDK","zACmK","mouseDown","load_entit","domElement","attach","HOVVb","WebGLRende","59319qQVoGl","nSnap","kMBOK","PisfI","updateProj","style","UUpIs","tionSnap","QuEMy","igKJJ","AirXr","ty-roll","cMyXs","ty-x","0|4|1|3|2","KckRJ","select_ent","IbpuU","lWMcO","XujjD","ZLFgq","LWMlv","prevX","PYhfO","cam","change","xrNYn","scrollHeig","push","categories","CGjqL","zxzUu","tLPDi","iAKFS","alpha","toggleMous","hash","PiaZn","TOQYe","xUTfq","ty-yaw","translate","order","VPHIh","setRotatio","60NrRXrh","l-name","stash","mousemove","6|3|4|2|5|","dvZmy","WLhhH","5|3|0|2|1|","13|8|2|1|9","entity","split","ty-z","documentEl","wqCis","innerHeigh","BRZfX","|10|0|6","7wxBZcX"];return(_0xe3e8=function(){return n})()}const mouseDownHandler=async n=>{var e=_0x139e,t={gGBQQ:function(n,e){return n&&e},qaOxs:function(n,e){return n!==e},TPgqe:e(218),KckRJ:function(n,e,t){return n(e,t)},cachS:e(254)+e(344),roaVh:function(n,e){return n!=e},kMBOK:function(n,e){return n==e},Ztnhj:function(n){return n()},uczQv:function(n,e){return n<e},cMmnF:function(n){return n()},zACmK:function(n,e){return n(e)},ZQqDK:e(252),OyNHk:function(n,e){return n!=e},zxzUu:function(n,e){return n==e},TGVmk:function(n){return n()}};if(!(isTransforming=!t[e(170)](isTransforming,!editingId)&&isTransforming)&&!t[e(182)](n[e(136)][e(323)],t[e(322)])){var n=tracking.x,r=tracking.y,a=await t[e(253)](Post,t[e(319)],{x:n,y:r});if(a[e(318)]&&t[e(182)](editingId,a[e(292)]))if(t[e(180)](decorateMenu,null)&&t[e(240)](decorateMenu[e(176)],2)){var o=await t[e(320)](getOwnedObjects);if(!t[e(240)](o[decorateMenu[e(267)][e(165)+"u"][e(285)]][e(305)],a[e(292)])){for(var c=null,i=0;t[e(169)](i,o[e(222)]);i++)if(t[e(240)](o[i][e(305)],a[e(292)])){c=i;break}t[e(180)](c,null)&&(decorateMenu[e(267)][e(165)+"u"][e(285)]=c),decorateMenu[e(267)][e(165)+"u"][e(176)]()}}else t[e(317)](clearData),editingId=a[e(292)],t[e(231)](changeEntity,editingId),isTransforming=!1;else if(!a[e(318)]){var u=t[e(230)][e(293)]("|");let n=0;for(;;){switch(u[n++]){case"0":if(t[e(144)](decorateMenu,null)&&t[e(269)](decorateMenu[e(176)],2))return;continue;case"1":editingId=null;continue;case"2":isTransforming=!1;continue;case"3":transformControls[e(225)]=!1;continue;case"4":t[e(204)](clearData);continue}break}}}},handleTracking=(window[_0x13f0c0(223)+_0x13f0c0(227)](_0x13f0c0(337),mouseDownHandler),n=>{var e=_0x13f0c0,t={iAKFS:function(n,e){return n-e},iVrrp:function(n,e){return n-e},eOBrb:function(n,e,t){return n(e,t)}},r=t[e(271)](n[e(185)],n[e(136)][e(326)]),n=t[e(304)](n[e(215)],n[e(136)][e(326)]);tracking.x=t[e(183)](normalize,r,document[e(295)+e(341)][e(325)+"h"]),tracking.y=t[e(183)](normalize,n,document[e(295)+e(341)][e(265)+"ht"])}),Scene=new _0x6a80ac[_0x13f0c0(201)],Renderer=new _0x6a80ac[_0x13f0c0(237)+_0x13f0c0(133)]({alpha:!0}),Camera=(Renderer[_0x13f0c0(343)](window[_0x13f0c0(137)],window[_0x13f0c0(297)+"t"]),document[_0x13f0c0(195)+_0x13f0c0(221)](_0x13f0c0(342))[_0x13f0c0(187)+"d"](Renderer[_0x13f0c0(234)]),new _0x6a80ac[_0x13f0c0(163)+_0x13f0c0(186)](50,window[_0x13f0c0(137)]/window[_0x13f0c0(297)+"t"],.1,1e4)),boxGeometry=(Camera[_0x13f0c0(172)][_0x13f0c0(280)]=_0x13f0c0(224),new _0x6a80ac[_0x13f0c0(334)+"y"](1,1,1)),meshPhongMaterial=new _0x6a80ac[_0x13f0c0(321)+_0x13f0c0(152)]({color:16711935,transparent:!0,opacity:0}),Mesh=new _0x6a80ac[_0x13f0c0(174)](boxGeometry,meshPhongMaterial);Mesh[_0x13f0c0(172)][_0x13f0c0(280)]=_0x13f0c0(224),Mesh[_0x13f0c0(331)][_0x13f0c0(328)](1,1,1),Scene[_0x13f0c0(135)](Mesh),Renderer[_0x13f0c0(234)][_0x13f0c0(243)][_0x13f0c0(156)]=_0x13f0c0(192);let animationFrameActive=null;function renderGeometry(){var n=_0x13f0c0;animationFrameActive={YusUs:function(n,e){return n(e)}}[n(141)](requestAnimationFrame,renderGeometry),Renderer[n(314)](Scene,Camera)}function showGeometry(){var n=_0x13f0c0,e={PWLtl:n(139)};transformControls[n(225)]=!1,Renderer[n(234)][n(243)][n(156)]=e[n(166)]}function hideGeometry(){var n=_0x13f0c0,e={LWMlv:n(192)};transformControls[n(225)]=!1,Renderer[n(234)][n(243)][n(156)]=e[n(259)]}function hideTransformControls(){var n=_0x13f0c0;transformControls[n(225)]=!1}const transformControls=new TransformControls(Camera,Renderer[_0x13f0c0(234)]);function _0x139e(n,e){const t=_0xe3e8();return(_0x139e=function(n,e){return n-=133,t[n]})(n,e)}transformControls[_0x13f0c0(223)+_0x13f0c0(227)](_0x13f0c0(263),()=>{var n=_0x13f0c0,e={fUfUs:function(n,e){return n(e)},CGjqL:function(n,e){return n(e)},MDIux:function(n,e){return n(e)},InjjU:function(n){return n()}},t=objectInfos[editingId];Mesh[n(134)].x&&Mesh[n(134)].y&&Mesh[n(134)].z&&t&&(t.x=Mesh[n(134)].x,t.y=-Mesh[n(134)].z,t.z=Mesh[n(134)].y,t[n(191)]=e[n(188)](radToDeg,Mesh[n(172)].x),t[n(146)]=e[n(268)](radToDeg,-Mesh[n(172)].z),t[n(155)]=e[n(311)](radToDeg,Mesh[n(172)].y),e[n(313)](editEntity),Renderer[n(314)](Scene,Camera))});const editEntity=()=>{var n=_0x13f0c0,e={oDamW:function(n,e,t){return n(e,t)},eHLAt:n(193)+"y",LEXzo:function(n,e){return n(e)},GuTch:function(n,e){return n(e)}},t=objectInfos[editingId];e[n(316)](Post,e[n(164)],{id:editingId,alpha:e[n(158)](parseInt,t[n(272)]),x:e[n(158)](parseFloat,t.x),y:e[n(158)](parseFloat,t.y),z:e[n(158)](parseFloat,t.z),pitch:e[n(158)](parseFloat,t[n(191)]),roll:e[n(158)](parseFloat,t[n(146)]),yaw:e[n(154)](parseFloat,t[n(155)])}),e[n(158)](setObjectHelperValues,t)},storeData=(transformControls[_0x13f0c0(223)+_0x13f0c0(227)](_0x13f0c0(232),()=>{var n=_0x13f0c0;isTransforming=!0,{PisfI:function(n){return n()}}[n(241)](storeData)}),transformControls[_0x13f0c0(223)+_0x13f0c0(227)](_0x13f0c0(228),()=>{var n=_0x13f0c0,e=objectInfos[editingId];e&&(e.x=Mesh[n(134)].x,e.y=-Mesh[n(134)].z,e.z=Mesh[n(134)].y,isTransforming=!1)}),transformControls[_0x13f0c0(339)+_0x13f0c0(245)](.1),transformControls[_0x13f0c0(343)](.8),transformControls[_0x13f0c0(282)+_0x13f0c0(239)](degToRad(15)),transformControls[_0x13f0c0(235)](Mesh),Scene[_0x13f0c0(135)](transformControls),()=>{var e=_0x13f0c0,t={cMyXs:function(n,e){return n!==e},WLhhH:function(n,e){return n!==e},AXDoB:e(290)+"4"},r=objectInfos[editingId];if(r&&t[e(250)](r.x,0)&&t[e(289)](r.y,0)&&t[e(289)](r.z,0)){var a=t[e(147)][e(293)]("|");let n=0;for(;;){switch(a[n++]){case"0":furniData[e(205)][e(266)](r.z);continue;case"1":furniData[e(138)][e(266)](r[e(146)]);continue;case"2":furniData[e(171)][e(266)](r[e(191)]);continue;case"3":furniData[e(148)][e(266)](r.y);continue;case"4":furniData[e(340)][e(266)](r[e(155)]);continue;case"5":furniData[e(260)][e(266)](r.x);continue}break}}});function cancelRenderGeometry(){var n=_0x13f0c0;animationFrameActive&&({KXKLL:function(n,e){return n(e)}}[n(167)](cancelAnimationFrame,animationFrameActive),animationFrameActive=null)}function setEditMode(n){var e=_0x13f0c0,t={FlGkL:function(n,e){return n===e},igKJJ:e(190),VcQRd:e(279)};t[e(157)](n,t[e(247)])?transformControls[e(302)](t[e(247)]):transformControls[e(302)](t[e(347)])}function setRotationSnap(n){var e=_0x13f0c0;transformControls[e(282)+e(239)](n)}function setTranslationSnap(n){var e=_0x13f0c0;transformControls[e(339)+e(245)](n)}const normalize=(n,e)=>{var t=_0x13f0c0,r={PiaZn:function(n,e){return n+e},wqCis:function(n,e){return n/e},IbpuU:function(n,e){return n*e},eDXJq:function(n,e){return n-e}};return r[t(275)](r[t(296)](r[t(255)](1,r[t(330)](n,0)),r[t(330)](e,0)),0)},handleUpdatePositions=(window[_0x13f0c0(223)+_0x13f0c0(227)](_0x13f0c0(286),handleTracking),n=>{var e=_0x13f0c0,t={dtOnE:function(n,e){return n(e)},kEhnS:function(n,e,t){return n(e,t)},PdCfv:function(n,e){return n(e)},AjWxp:function(n,e){return n(e)}},r=(Camera[e(134)][e(328)](n[e(262)][e(134)].x,n[e(262)][e(134)].z,-n[e(262)][e(134)].y),n[e(262)][e(172)].x),a=n[e(262)][e(172)].z,o=n[e(262)][e(172)].y;Camera[e(172)][e(328)](t[e(306)](degToRad,r),t[e(306)](degToRad,t[e(175)](zRotationHandler,r,a)),t[e(220)](degToRad,o)),Camera[e(310)]=n[e(262)][e(310)],Camera[e(242)+e(159)+"ix"](),n[e(292)][e(134)]&&(Mesh[e(134)][e(328)](n[e(292)][e(134)].x,n[e(292)][e(134)].z,-n[e(292)][e(134)].y),Mesh[e(172)][e(328)](t[e(200)](degToRad,n[e(292)][e(172)].x),t[e(200)](degToRad,n[e(292)][e(172)].z),t[e(220)](degToRad,-n[e(292)][e(172)].y)))}),changeEntity=async n=>{var e=_0x13f0c0,t={YaZbv:function(n,e,t){return n(e,t)},vdMdH:e(233)+e(315),KwgDv:function(n,e){return n(e)},WgTrs:function(n,e){return n(e)}},n=await t[e(333)](Post,t[e(301)],{id:t[e(217)](parseInt,n)});t[e(213)](setEntityData,n)},zRotationHandler=(n,e)=>{var t=_0x13f0c0,r={tbafT:function(n,e){return e<n},HOVVb:function(n,e){return n<e},UUpIs:function(n,e){return n<e},xrNYn:function(n,e){return e<n}};return(!r[t(327)](n,0)||!r[t(236)](n,90))&&(r[t(327)](n,-180)&&r[t(244)](n,-90)||r[t(264)](n,0))?-e:e},setEntityData=n=>{var e=_0x13f0c0,t={AirXr:e(178)+e(207)+e(291)+e(299),LROiV:function(n,e){return n(e)},KfYFJ:function(n,e){return n!==e},PYhfO:function(n){return n()}},r=t[e(248)][e(293)]("|");let a=0;for(;;){switch(r[a++]){case"0":transformControls[e(225)]=!0;continue;case"1":editingData[e(146)]=n[e(146)];continue;case"2":editingData[e(191)]=n[e(191)];continue;case"3":if(n[e(309)])continue;return editable=!1,void(transformControls[e(225)]=!1);case"4":objectInfos[editingId]={id:n.id,hash:n[e(274)],alpha:n[e(272)],x:n.x,y:n.y,z:n.z,pitch:n[e(191)],roll:n[e(146)],yaw:n[e(155)],distance:n[e(150)],quaternion:{}};continue;case"5":editingData.x=n.x;continue;case"6":t[e(203)](setObjectHelperValues,n);continue;case"7":editingData[e(274)]=n[e(274)];continue;case"8":editingData.z=n.z;continue;case"9":editingData[e(155)]=n[e(155)];continue;case"10":editingData[e(150)]=n[e(150)];continue;case"11":editingId=n.id;continue;case"12":t[e(214)](editingId,n.id)&&t[e(261)](clearData);continue;case"13":editingData.y=n.y;continue;case"14":editingData[e(272)]=n[e(272)];continue;case"15":editable=!0;continue}break}},setObjectHelperValues=n=>{var e=_0x13f0c0,t={IYEFP:e(287)+e(345),eTAyX:function(n,e){return n(e)},gcBcU:e(145)+e(198)+e(249),XYpgJ:function(n,e){return n(e)},IYOFa:e(145)+e(198)+e(278),IOuTw:function(n,e){return n(e)},UUbmb:e(145)+e(198)+e(294),QwmPu:function(n,e){return n(e)},OYnAB:e(145)+e(198)+e(251),xUTfq:e(145)+e(198)+e(142),lPkNz:e(145)+e(198)+e(181),NrxyS:function(n,e){return n(e)},dvZmy:e(145)+e(312)+e(284)},r=t[e(153)][e(293)]("|");let a=0;for(;;){switch(r[a++]){case"0":t[e(196)]($,t[e(211)])[e(177)](n[e(146)]);continue;case"1":t[e(161)]($,t[e(332)])[e(177)](n[e(155)]);continue;case"2":t[e(189)]($,t[e(194)])[e(177)](n.z);continue;case"3":t[e(208)]($,t[e(160)])[e(177)](n.x);continue;case"4":t[e(196)]($,t[e(277)])[e(177)](n.y);continue;case"5":t[e(161)]($,t[e(206)])[e(177)](n[e(191)]);continue;case"6":t[e(168)]($,t[e(288)])[e(177)](n[e(274)]);continue}break}},clearData=()=>{var n=_0x13f0c0,e={KrKKv:n(173)+"5"}[n(210)][n(293)]("|");let t=0;for(;;){switch(e[t++]){case"0":furniData[n(171)]=[];continue;case"1":furniData[n(138)]=[];continue;case"2":furniData[n(148)]=[];continue;case"3":furniData[n(205)]=[];continue;case"4":furniData[n(260)]=[];continue;case"5":furniData[n(340)]=[];continue}break}};window[_0x13f0c0(223)+_0x13f0c0(227)](_0x13f0c0(140),async n=>{var e=_0x13f0c0,t={VPHIh:function(n,e){return n===e},WmmrN:function(n,e){return n(e)},fGxwl:e(273)+e(212),TOQYe:function(n,e){return n===e},BRZfX:function(n,e){return n(e)},QuEMy:e(151)+"or",LHFdj:function(n,e){return n===e},ZLFgq:function(n,e,t){return n(e,t)},wHcAw:e(346)+e(226),VnFxC:function(n,e){return n(e)}};t[e(281)](n[e(179)],"F6")&&t[e(202)](Post,t[e(303)]),t[e(276)](n[e(179)],"F5")&&t[e(298)](Post,t[e(246)]),(t[e(276)](n[e(179)],"G")||t[e(197)](n[e(179)],"g"))&&(n=await t[e(258)](Post,t[e(216)],{id:t[e(202)](parseInt,editingId)}),t[e(329)](setEntityData,n))});export{setDecorateMenu,selectLegacyObject,renderGeometry,showGeometry,hideGeometry,hideTransformControls,cancelRenderGeometry,setEditMode,setRotationSnap,setTranslationSnap,handleUpdatePositions,changeEntity};